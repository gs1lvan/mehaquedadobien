<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test - Kitchen Appliances</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        body {
            padding: 20px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        .test-section {
            margin-bottom: 40px;
            padding: 20px;
            border: 2px solid #ddd;
            border-radius: 8px;
        }
        .test-section h2 {
            margin-top: 0;
            color: #333;
        }
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .test-pass {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .test-info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        button {
            margin: 5px;
            padding: 10px 20px;
            font-size: 14px;
            cursor: pointer;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
        }
        button:hover {
            background: #0056b3;
        }
    </style>
</head>
<body>
    <h1>🧪 Test - Aparatos de Cocina</h1>
    
    <div class="test-section">
        <h2>Chips de Aparatos</h2>
        <p>Haz clic en los aparatos para seleccionarlos/deseleccionarlos:</p>
        
        <div id="kitchen-appliances-chips" class="kitchen-appliances-chips">
            <!-- Chips will be added here -->
        </div>
        
        <div id="selected-appliances" class="test-info" style="margin-top: 20px;">
            <strong>Aparatos seleccionados:</strong> <span id="selected-list">Ninguno</span>
        </div>
    </div>
    
    <div class="test-section">
        <h2>Prueba de Guardado</h2>
        <p>Simula guardar una receta con los aparatos seleccionados:</p>
        
        <button onclick="testSaveRecipe()">💾 Guardar Receta de Prueba</button>
        
        <div id="save-result" style="margin-top: 20px;"></div>
    </div>
    
    <script src="models.js"></script>
    <script>
        // Kitchen appliances list
        const KITCHEN_APPLIANCES = [
            { id: 'sarten', name: 'Sartén', emoji: '🍳' },
            { id: 'olla', name: 'Olla', emoji: '🍲' },
            { id: 'olla-presion', name: 'Olla a presión', emoji: '⚡' },
            { id: 'horno', name: 'Horno', emoji: '🔥' },
            { id: 'microondas', name: 'Microondas', emoji: '📻' },
            { id: 'freidora-aire', name: 'Freidora de aire', emoji: '💨' },
            { id: 'sandwichera', name: 'Sandwichera', emoji: '🥪' },
            { id: 'batidora', name: 'Batidora', emoji: '🌀' }
        ];
        
        let selectedAppliances = [];
        
        // Render chips
        function renderChips() {
            const container = document.getElementById('kitchen-appliances-chips');
            container.innerHTML = '';
            
            KITCHEN_APPLIANCES.forEach(appliance => {
                const chip = document.createElement('button');
                chip.type = 'button';
                chip.className = 'appliance-chip';
                chip.dataset.applianceId = appliance.id;
                chip.innerHTML = `${appliance.emoji} ${appliance.name}`;
                
                if (selectedAppliances.includes(appliance.id)) {
                    chip.classList.add('selected');
                }
                
                chip.addEventListener('click', () => {
                    toggleAppliance(appliance.id);
                });
                
                container.appendChild(chip);
            });
            
            updateSelectedList();
        }
        
        // Toggle appliance selection
        function toggleAppliance(applianceId) {
            const index = selectedAppliances.indexOf(applianceId);
            
            if (index > -1) {
                selectedAppliances.splice(index, 1);
            } else {
                selectedAppliances.push(applianceId);
            }
            
            renderChips();
        }
        
        // Update selected list display
        function updateSelectedList() {
            const listElement = document.getElementById('selected-list');
            
            if (selectedAppliances.length === 0) {
                listElement.textContent = 'Ninguno';
            } else {
                const names = selectedAppliances.map(id => {
                    const appliance = KITCHEN_APPLIANCES.find(a => a.id === id);
                    return appliance ? `${appliance.emoji} ${appliance.name}` : '';
                }).filter(n => n !== '');
                
                listElement.textContent = names.join(', ');
            }
        }
        
        // Test save recipe
        function testSaveRecipe() {
            const resultDiv = document.getElementById('save-result');
            
            try {
                const testRecipe = new Recipe({
                    name: 'Receta de Prueba con Aparatos',
                    category: 'carne',
                    totalTime: '1h',
                    kitchenAppliances: selectedAppliances,
                    ingredients: [
                        new Ingredient({ name: 'Pollo', quantity: 500, unit: 'g', order: 0 })
                    ],
                    preparationMethod: 'Cocinar el pollo usando los aparatos seleccionados.'
                });
                
                resultDiv.innerHTML = `
                    <div class="test-pass">
                        ✓ Receta creada exitosamente
                        <br><br>
                        <strong>Datos de la receta:</strong>
                        <ul>
                            <li>Nombre: ${testRecipe.name}</li>
                            <li>Aparatos: ${testRecipe.kitchenAppliances.length > 0 ? testRecipe.kitchenAppliances.join(', ') : 'Ninguno'}</li>
                        </ul>
                        <br>
                        <strong>JSON:</strong>
                        <pre>${JSON.stringify(testRecipe.toJSON(), null, 2)}</pre>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="test-result" style="background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb;">
                        ✗ Error al crear receta: ${error.message}
                    </div>
                `;
            }
        }
        
        // Initialize
        renderChips();
    </script>
</body>
</html>
